<!-- ç¤¾åŒºåŠ¨æ€é¡µ -->
<view class="container">
  <!-- åŠ¨æ€åˆ—è¡¨ -->
  <scroll-view 
    class="posts-scroll" 
    scroll-y 
    refresher-enabled="{{true}}"
    refresher-triggered="{{refreshing}}"
    bindrefresherrefresh="onRefresh"
    bindscrolltolower="onLoadMore"
  >
    <view class="posts-list" wx:if="{{posts.length > 0}}">
      <view 
        class="post-item" 
        wx:for="{{posts}}" 
        wx:key="id"
        bindtap="onPostTap"
        data-post="{{item}}"
      >
        <!-- ç”¨æˆ·ä¿¡æ¯ -->
        <view class="post-header">
          <image class="user-avatar" src="{{item.userAvatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
          <view class="user-info">
            <text class="user-name">{{item.userName || 'åŒ¿åç”¨æˆ·'}}</text>
            <text class="post-time">{{item.createTime}}</text>
          </view>
        </view>

        <!-- å†…å®¹ -->
        <view class="post-content">
          <text class="post-text">{{item.content}}</text>
          <view class="post-images" wx:if="{{item.images && item.images.length > 0}}">
            <image 
              class="post-image" 
              wx:for="{{item.images}}" 
              wx:key="*this"
              wx:for-item="img"
              src="{{img}}" 
              mode="aspectFill"
              bindtap="previewImage"
              data-urls="{{item.images}}"
              data-current="{{img}}"
            ></image>
          </view>
        </view>

        <!-- æ“ä½œæ  -->
        <view class="post-actions">
          <view class="action-item" bindtap="onLike" data-id="{{item.id}}" data-index="{{index}}">
            <text class="action-icon">ğŸ‘</text>
            <text class="action-count">{{item.likeCount || 0}}</text>
          </view>
          <view class="action-item" bindtap="onComment" data-id="{{item.id}}">
            <text class="action-icon">ğŸ’¬</text>
            <text class="action-count">{{item.commentCount || 0}}</text>
          </view>
          <view class="action-item" bindtap="onShare" data-id="{{item.id}}">
            <text class="action-icon">ğŸ”—</text>
            <text>åˆ†äº«</text>
          </view>
        </view>
      </view>
    </view>
    <empty wx:else text="æš‚æ— åŠ¨æ€ï¼Œå¿«æ¥å‘å¸ƒç¬¬ä¸€æ¡å§~" show-action="{{true}}">
      <view slot="action">
        <button class="btn btn-primary" bindtap="navigateToPublish">å‘å¸ƒåŠ¨æ€</button>
      </view>
    </empty>

    <!-- åŠ è½½æ›´å¤šç»„ä»¶ -->
    <loading-more 
      show="{{posts.length > 0}}"
      loading="{{loadingMore}}"
      loading-text="åŠ è½½ä¸­..."
      no-more-text="æ²¡æœ‰æ›´å¤šäº†"
    ></loading-more>
  </scroll-view>

  <!-- å‘å¸ƒæŒ‰é’® -->
  <view class="fab" bindtap="navigateToPublish">
    <text class="fab-icon">+</text>
  </view>
</view>

<!-- åŠ è½½ç»„ä»¶ -->
<loading show="{{loading}}" text="åŠ è½½ä¸­..."></loading>
