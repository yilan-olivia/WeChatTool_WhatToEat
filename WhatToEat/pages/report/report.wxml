<!-- å¥åº·æŠ¥å‘Šé¡µ -->
<view class="container">
  <!-- æ—¶é—´é€‰æ‹© -->
  <view class="time-selector">
    <picker mode="date" value="{{startDate}}" start="{{minDate}}" end="{{maxDate}}" bindchange="onStartDateChange">
      <view class="date-item">
        <text class="date-label">å¼€å§‹æ—¥æœŸ</text>
        <text class="date-value">{{startDate}}</text>
      </view>
    </picker>
    <text class="date-separator">è‡³</text>
    <picker mode="date" value="{{endDate}}" start="{{startDate}}" end="{{maxDate}}" bindchange="onEndDateChange">
      <view class="date-item">
        <text class="date-label">ç»“æŸæ—¥æœŸ</text>
        <text class="date-value">{{endDate}}</text>
      </view>
    </picker>
    <button class="btn btn-primary query-btn" bindtap="queryReport">æŸ¥è¯¢</button>
  </view>

  <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
  <view class="stats-overview" wx:if="{{reportData}}">
    <view class="overview-title">ç»Ÿè®¡æ¦‚è§ˆ</view>
    <view class="stats-grid">
      <view class="stat-box">
        <text class="stat-value">{{reportData.totalFoods || 0}}</text>
        <text class="stat-label">èœå“æ€»æ•°</text>
      </view>
      <view class="stat-box">
        <text class="stat-value">{{reportData.totalRecipes || 0}}</text>
        <text class="stat-label">ç”Ÿæˆé£Ÿè°±</text>
      </view>
      <view class="stat-box">
        <text class="stat-value">{{reportData.avgCalories || 0}}</text>
        <text class="stat-label">å¹³å‡çƒ­é‡</text>
      </view>
      <view class="stat-box">
        <text class="stat-value">{{reportData.wasteCount || 0}}</text>
        <text class="stat-label">æµªè´¹æ•°é‡</text>
      </view>
    </view>
  </view>

  <!-- åˆ†ç±»ç»Ÿè®¡ -->
  <view class="category-stats" wx:if="{{reportData && reportData.categoryStats}}">
    <view class="section-title">åˆ†ç±»ç»Ÿè®¡</view>
    <nutrition-bar 
      nutrition-data="{{categoryNutritionData}}" 
      show-percentage="{{true}}"
    ></nutrition-bar>
  </view>

  <!-- å¥åº·å»ºè®® -->
  <view class="health-tips" wx:if="{{reportData && reportData.tips}}">
    <view class="section-title">å¥åº·å»ºè®®</view>
    <view class="tips-list">
      <view 
        class="tip-item"
        wx:for="{{reportData.tips}}" 
        wx:key="index"
      >
        <text class="tip-icon">ğŸ’¡</text>
        <text class="tip-text">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <empty wx:if="{{!reportData && !loading}}" text="æš‚æ— æ•°æ®ï¼Œè¯·é€‰æ‹©æ—¥æœŸèŒƒå›´æŸ¥è¯¢"></empty>
</view>

<!-- åŠ è½½ç»„ä»¶ -->
<loading show="{{loading}}" text="ç”ŸæˆæŠ¥å‘Šä¸­..."></loading>
